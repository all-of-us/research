plugins {
    id "org.liquibase.gradle" version "2.0.4"
}
repositories {
    mavenCentral()
}
buildscript {
    repositories {
        // Bintray's repository - a fast Maven Central mirror & more
        mavenCentral()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath 'org.liquibase:liquibase-gradle-plugin:2.0.4'
        classpath 'mysql:mysql-connector-java:5.1.37'
    }
}
apply plugin: 'org.liquibase.gradle'

def db_host = System.getenv("DB_HOST") ?: "db"
def db_port = System.getenv("DB_PORT") ?: "3306"
def liquibase_password = System.getenv("LIQUIBASE_DB_PASSWORD") ?: "lb-notasecret"

dependencies {
    liquibaseRuntime 'org.liquibase:liquibase-core:3.10.0'
    liquibaseRuntime("ch.qos.logback:logback-core:1.2.3")
    liquibaseRuntime 'mysql:mysql-connector-java:5.1.37'
}
liquibase {
    activities {
        main {
            changeLogFile "changelog/db.changelog-master.xml"
            url "jdbc:mysql://${db_host}:${db_port}/workbench"
            username "liquibase"
            password "${liquibase_password}"
        }
        runList = project.ext.runList
    }
}
