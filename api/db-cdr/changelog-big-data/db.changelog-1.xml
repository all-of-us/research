<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
  <changeSet author="biopete" id="add concept and concept relationship indexes">
    <createIndex
      indexName="idx_concept_name"
      schemaName="cdr"
      tableName="concept"
      unique="false">
      <column name="concept_name" type="varchar(255)"/>
    </createIndex>
    <createIndex
      indexName="idx_concept_code"
      schemaName="cdr"
      tableName="concept"
      unique="false">
      <column name="concept_code" type="varchar(50)"/>
    </createIndex>
    <createIndex
      indexName="idx_domain_id"
      schemaName="cdr"
      tableName="concept"
      unique="false">
      <column name="domain_id" type="varchar(20)"/>
    </createIndex>

    <createIndex
      indexName="idx_vocabulary_id"
      schemaName="cdr"
      tableName="concept"
      unique="false">
      <column name="vocabulary_id" type="varchar(20)"/>
    </createIndex>
    <createIndex
      indexName="idx_standard_concept"
      schemaName="cdr"
      tableName="concept"
      unique="false">
      <column name="standard_concept" type="varchar(1)"/>
    </createIndex>

    <createIndex tableName="concept" schemaName="cdr" indexName="idx-count-value">
      <column name="count_value" defaultValue="0" type="bigint(20)"/>
    </createIndex>

    <sql dbms="mysql">
      ALTER TABLE cdr.concept
      ADD FULLTEXT INDEX concept_name_index
      (concept_name);
    </sql>

    <sql dbms="mysql">
      ALTER TABLE cdr.concept
      ADD FULLTEXT INDEX concept_code_index
      (concept_code);
    </sql>

    <createIndex tableName="concept_relationship" indexName="idx-concept-1">
      <column name="concept_id_1" type="bigint"></column>
    </createIndex>

    <createIndex tableName="concept_relationship" indexName="idx-concept-2" schemaName="cdr">
      <column name="concept_id_2" type="bigint"></column>
    </createIndex>

    <createIndex tableName="concept_relationship" indexName="idx-relationship-id" schemaName="cdr">
      <column name="relationship_id" type="varchar(20)"></column>
    </createIndex>
  </changeSet>
</databaseChangeLog>
