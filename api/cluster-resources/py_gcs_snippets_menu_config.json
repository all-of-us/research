{"name": "All of Us Python and Cloud Storage snippets", "sub-menu": [{"name": "Documentation", "external-link": "https://github.com/all-of-us/workbench-snippets"}, "---", {"name": "(1) Setup", "snippet": "import os\nimport numpy as np\nimport pandas as pd\n\n\n"}, {"name": "(2) Copy file to or from Workspace Bucket", "sub-menu": [{"name": "copy_data_to_workspace_bucket.py", "snippet": "# This snippet assumes you run setup first\n\n# This code saves your dataframe into a csv file in a \"data\" folder in Google Bucket\n\n# Replace df with THE NAME OF YOUR DATAFRAME\nmy_dataframe = df   \n\n# Replace 'test.csv' with THE NAME of the file you're going to store in the bucket (don't delete the quotation marks)\ndestination_filename = 'test.csv'\n\n########################################################################\n##\n################# DON'T CHANGE FROM HERE ###############################\n##\n########################################################################\n\n# save dataframe in a csv file in the same workspace as the notebook\nmy_dataframe.to_csv(destination_filename, index=False)\n\n# get the bucket name\nmy_bucket = os.getenv('WORKSPACE_BUCKET')\n\n# copy csv file to the bucket\nos.system(f\"gsutil cp './{destination_filename}' '{my_bucket}/data/'\")\nprint(f'[INFO] {destination_filename} is successfully uploaded in your bucket.')\n"}, {"name": "copy_file_from_workspace_bucket.py", "snippet": "# This snippet assumes you run setup first\n\n# This code copies file in your Google Bucket and loads it into a dataframe\n\n# Replace 'test.csv' with THE NAME of the file you're going to download from the bucket (don't delete the quotation marks)\nname_of_file_in_bucket = 'test.csv'\n\n########################################################################\n##\n################# DON'T CHANGE FROM HERE ###############################\n##\n########################################################################\n\n# get the bucket name\nmy_bucket = os.getenv('WORKSPACE_BUCKET')\n\n# copy csv file from the bucket to the current working space\nos.system(f\"gsutil cp '{my_bucket}/data/{name_of_file_in_bucket}' .\")\n\nprint(f'[INFO] {name_of_file_in_bucket} is successfully downloaded into your working space')\n# save dataframe in a csv file in the same workspace as the notebook\nmy_dataframe = pd.read_csv(name_of_file_in_bucket)\nmy_dataframe.head()\n"}]}]}