

<div class="row flex-items-xs-middle">
  <div class="col-xs-12">
    <h2 class="title">  {{title}} </h2>
  </div>
  <div class="col-md-8 col-sm-10 col-xs-11">
    <div class="white-card-box" >
      <div class="row search  flex-items-xs-between">
        <div class="col-xs-12 flex-xs-middle search-input-full">
          <div class="search-wrapper ">
            <clr-icon shape="search" class="input-icon-absolute is-info"></clr-icon>
            <input type="text" id="search-db" placeholder="Keyword Search" [formControl]="searchText" autofocus>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4 col-sm-2 col-xs-1" *ngIf="loading" >
    <span  class="spinner spinner-lg hidden-sm-down">Loading ...</span>
    <span  class="spinner spinner-md hidden-md-up">Loading ...</span>
  </div>
</div>

<div class="row flex-items-xs-middle">
  <div class="col-xs-12">
    <h2 class="title">  {{title}} </h2>
  </div>
</div>

  <div class="row ">
        <div class="col-md-8 col-sm-10 col-xs-11 white-card-box flex-xs-middle search-input-full">
          <div class="search-wrapper ">
            <clr-icon shape="search" class="input-icon-absolute is-info"></clr-icon>
            <input type="text" id="search-db" placeholder="Keyword Search" [formControl]="searchText" autofocus>
          </div>
        </div>

  <div class="col-md-4 col-sm-2 col-xs-1 flex-xs-middle" *ngIf="loading" >
    <span  class="spinner spinner-lg hidden-sm-down">Loading ...</span>
    <span  class="spinner spinner-md hidden-md-up">Loading ...</span>
  </div>
</div>

<!-- Top summary boxes -- only show if have results -->
<div class="row white-card-box top-stat one-row" *ngIf="items.length > 0">

        <div class="col-md-4 col-sm-6 col-xs-12">
          <div class="row">
          <h5 class="col-xs-12 box-title">
            {{dbDomain.domainDisplay}}
          </h5>
          </div>

          <div class="row">
          <div class="col-md-4 col-sm-6 col-xs-6 card-stat" >
            {{items.length}}
          </div>
            <div class="col-md-8 col-sm-6 col-xs-6 card-text">
              matching medical concepts.
            </div>
          </div>
          <div class="row">

          </div>

          <div class="row">
          <div class="col-xs-12 card-text">
            Total participants: {{totalParticipants}}
          </div>
          </div>
        </div>

        <div class="col-md-8 col-sm-6 col-xs-12  flex-xs-middle">
          <app-chart [concepts]="top10Results" [chartTitle]="'Top 10 by particpant count'" [pointWidth]="20" [backgroundColor]="'#D9E4EA'"> </app-chart>
        </div>


</div>

<div class="row" *ngIf="items.length > 0">
  <div class="col-xs-12">
    <div class="white-card-box top-stat one-row">
      <div class="row" >
        <div class="col-md-4 col-xs-12">
          <h5 class="box-title">
            {{dbDomain.domainDisplay}}
          </h5>
          <div class="card-stat" >
            {{items.length}}
          </div>
          <div class="card-text">
            matching medical concepts.
          </div>
          <div class="card-text bottom info-text">
            Total participants: {{totalParticipants}}
          </div>
        </div>
        <div class="col-md-8 col-xs-12 chart-wrapper flex-xs-middle">
            <app-chart [concepts]="top10Results" [chartTitle]="'Top 10 by particpant count'" [pointWidth]="20" [backgroundColor]="'#D9E4EA'"> </app-chart>
        </div>
      </div>
    </div>
  </div>
</div>



<div  class="row result-list">
  <div class="col-xs-12">
    <div class="white-card-box">

      <div class="results-grid" *ngIf="items.length > 0" >
        <div class="row" *ngIf="items.length === 1 && items[0].standardConcept != 'S'">
          <div class="col-xs-12 db-alert">
            <clr-alert  [clrAlertClosable]="false" [clrAlertType]="info">
              Note: {{items[0].vocabularyId}} {{items[0].conceptCode}} "{{items[0].conceptName}}"
              maps to a Standard Vocabulary {{standardConcepts[0].vocabularyId}} {{standardConcepts[0].conceptCode}}
              and any listed below. Standard vocabularies capture data across a variety of source vocabularies.
            </clr-alert>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4 grid-header flex-xs-middle"> {{dbDomain.domainDisplay}}</div>
          <div class="col-md-4 grid-header flex-xs-middle"> Number of particpants </div>
          <div class="col-md-3 grid-header flex-xs-middle info-text"> <clr-icon class="" shape="info-standard" class="is-solid"></clr-icon> What is SNOMED? </div>
          <div class="col-md-1 grid-header flex-xs-middle info-text"> View graphs </div>

        </div>
        <div class="row expandable-grid-row" (click)="r.expanded = !r.expanded"
             *ngFor="let r of items.concat(standardConcepts), let i = index"
             [ngClass]="{'expanded-grid-row': r.expanded}" >
          <div class="col-md-4 flex-xs-middle" innerHtml="{{i+1}}. {{r.conceptName | highlightSearch : prevSearchText}}"> </div>
          <div class="col-md-4 flex-xs-middle">
            {{r.countValue | number }} out of {{totalParticipants | number}} participants

          </div>
          <div class="col-md-3 flex-xs-middle">
            {{r.vocabularyId}} {{r.conceptCode}}
          </div>
          <div class="col-md-1 flex-xs-middle">
            <button class="icon-btn" (click)="r.expanded = !r.expanded">
              <clr-icon shape="bar-chart" style="height: 1rem; width: 1rem;color: #2691D0;"></clr-icon>
            </button>
          </div>
          <div class="col-xs-12 row-expansion flex-xs-middle" *ngIf="r.expanded">
            <app-concept-charts [concept]="r" [showSources]="true" [backgroundColor]="'#ECF1F4'"></app-concept-charts>
          </div>
        </div>
      </div>

      <div class="results-grid">
        <div class="row" *ngIf="!loading && items.length === 0">
          <div class="col-xs-12">
            <h5 class="no-results"> No results match your search. </h5>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4 col-xs-12">
            <button class="btn btn-primary btn-sm" [routerLink]="['/quick-search']"> Back to Quick Search </button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
