<form (ngSubmit)="createAccount()" *ngIf="!accountCreated">
  <h2>Create your account</h2>
  <div class="form-area">
    <div class="form-section">
      <input type="text" class="long-input" id="givenName" name="givenName" autofocus [(ngModel)]="profile.givenName" placeholder="Given Name">
    </div>
    <div class="form-section">
      <input type="text" class="long-input" id="familyName" name="familyName" [(ngModel)]="profile.familyName" placeholder="Family Name">
    </div>
    <div class="form-section">
      <input type="text" class="long-input" id="contactEmail" name="contactemail" [(ngModel)]="profile.contactEmail" (ngModelChange)="contactEmailChanged()" placeholder="Email Address">
      <div *ngIf="contactEmailConflictError" class="error">
        Contact Email is already in use.
      </div>
    </div>
    <div class="form-section">
      <input type="text" class="short-input" id="username" name="username"
             [(ngModel)]="profile.username" (ngModelChange)="usernameChanged()" (blur)="leaveFocusUsername()"
             (focus)="enterFocusUsername()" placeholder="New Username"
             [ngClass]="{'successfulInput': showUsernameValidationSuccess, 'unsuccessfulInput': showUsernameValidationError}">
      <div class="icon-area">
        <clr-icon shape="warning-standard" class="warning-standard is-solid" *ngIf="showUsernameValidationError"></clr-icon>
        <clr-icon shape="success-standard" class="success-standard is-solid" *ngIf="showUsernameValidationSuccess"></clr-icon>
      </div>
      <clr-tooltip>
        <clr-icon clrTooltipTrigger shape="info-standard" class="is-solid info-icon"></clr-icon>
        <clr-tooltip-content clrPosition="top-right" clrSize="lg" *clrIfOpen>
          <div>
            Usernames can contain only letters (a-z), numbers (0-9), dashes (-), underscores (_),
            apostrophes ('), and periods (.) (maximum of 64 characters).
          </div>
          <br>
          <div>
            Usernames cannot begin or end with a period (.) and may not contain more than one
            period (.) in a row.
          </div>
        </clr-tooltip-content>
      </clr-tooltip>
      <div *ngIf="usernameConflictError && usernameOffFocus" class="error">
        Username is already taken.
      </div>
      <div *ngIf="usernameInvalidError && usernameOffFocus" class="error">
        Username is not a valid username.
      </div>
    </div>
    <div class="form-section">
      <input type="password" class="short-input" id="password" name="password" [(ngModel)]="password" placeholder="Password"
             (blur)="leaveFocusPassword()" (focus)="enterFocusPassword()"
             [ngClass]="{'successfulInput': showPasswordValidationSuccess, 'unsuccessfulInput': showPasswordValidationError}">
      <div class="icon-area">
        <clr-icon shape="warning-standard" class="warning-standard is-solid" *ngIf="showPasswordValidationError"></clr-icon>
        <clr-icon shape="success-standard" class="success-standard is-solid" *ngIf="showPasswordValidationSuccess"></clr-icon>
      </div>
      <clr-tooltip>
        <clr-icon clrTooltipTrigger shape="info-standard" class="is-solid info-icon"></clr-icon>
        <clr-tooltip-content clrPosition="top-right" clrSize="lg" *clrIfOpen>
          Passwords must contain at least one lowercase and one uppercase letter
        </clr-tooltip-content>
      </clr-tooltip>
      <div *ngIf="showPasswordLengthError && passwordOffFocus" class="error">
        Password must be between 8 and 100 characters long.
      </div>
      <div *ngIf="containsLowerAndUpperError && passwordOffFocus" class="error">
        Password must contain one lowercase and one uppercase letter.
      </div>
    </div>
    <div class="form-section">
      <input type="password" class="short-input" for="passwordAgain" name="passwordAgain"
             (blur)="leaveFocusPasswordAgain()" (focus)="enterFocusPasswordAgain()"
             [(ngModel)]="passwordAgain" placeholder="Confirm Password"
             [ngClass]="{'successfulInput': showPasswordAgainValidationSuccess, 'unsuccessfulInput': showPasswordAgainValidationError}">
      <div class="icon-area">
        <clr-icon shape="warning-standard" class="warning-standard is-solid" *ngIf="showPasswordAgainValidationError"></clr-icon>
        <clr-icon shape="success-standard" class="success-standard is-solid" *ngIf="showPasswordAgainValidationSuccess"></clr-icon>
      </div>
    </div>
    <div *ngIf="showPasswordsDoNotMatchError && passwordAgainOffFocus" class="error">
      Passwords do not match.
    </div>
    <div class="form-section">
      <button type="submit"
          class="btn btn-primary short-button"
          [disabled]="creatingAccount"
          [clrLoading]="creatingAccount">
        Next
      </button>
    </div>
    <div *ngIf="showAllFieldsRequiredError" class="error">
      All fields are required.
    </div>
  </div>
</form>
<div *ngIf="accountCreated">
  <app-account-creation-success></app-account-creation-success>
</div>
