<clr-wizard
  [clrWizardOpen]="open"
  (clrWizardOnCancel)="cancel()"
  (clrWizardOnFinish)="finish()">

  <clr-wizard-title>Add Criteria To Cohort</clr-wizard-title>

  <clr-wizard-page><!-- Criteria Selection Page -->
    <ng-template clrPageTitle>{{ critPageTitle }}</ng-template>
    <div id="criteria-page">
      <div class="criteria-tree-container">

        <!-- 
          TODO (jms) Push this into its own component? There's some silly race
          condition by having the modal read whether or not the child is
          loading directly from the child that using a dedicated component
          could avoid.
        -->
        <div *ngIf="rootsAreLoading" class="spinner">
          Loading...
        </div>

        <!-- TODO(jms) Push this into its own component? -->
        <div *ngIf="hasErrors" class="error-box">
          <clr-alert
            [clrAlertClosable]="false"
            [clrAlertType]="'alert-danger'">
            <div clr-alert-item class="alert-item"
              *ngFor="let error of criteriaErrors">
              <span class="alert-text">
                Failed to load children of {{ error.kind }} with ID {{ error.parentId }}.
              </span>
              <div class="alert-actions">
                <a (click)="closeAlert(error)">
                  <clr-icon shape="close"></clr-icon>
                </a>
              </div>
            </div>
          </clr-alert>
        </div>

        <app-criteria-tree [node]="rootNode" (isLoading)="setLoading($event)">
        </app-criteria-tree>

      </div>
      <app-wizard-criteria-group></app-wizard-criteria-group>
    </div>
  </clr-wizard-page>

  <clr-wizard-button [type]="'cancel'">Cancel</clr-wizard-button>
  <clr-wizard-button [type]="'previous'">Back</clr-wizard-button>
  <clr-wizard-button [type]="'next'">Next</clr-wizard-button>
  <clr-wizard-button [type]="'finish'">Finish</clr-wizard-button>

</clr-wizard>
