<clr-modal
  [clrModalOpen]="open"
  (clrModalOpenChange)="openChange($event)"
  [clrModalStaticBackdrop]="true"
  [clrModalSize]="'lg'">

  <div class="modal-title">
    <h3>
    Choose Demographics Filters
    <clr-icon shape="info-circle" class="is-highlight"
      [popper]="explanation"
      [popperTrigger]="'hover'"
      [popperPlacement]="'right'">
    </clr-icon>
    </h3>
    <popper-content #explanation>
      <p>
        The four subcategories of Demographics (Age, Gender, Race, and Deceased
        Status) are joined together with a Boolean <strong>AND</strong>.  For
        example, you may wish to search for people who identify as Female
        <em>and</em> Asian.
      </p>
      <p>
        Values <em>within</em> a subcategory are joined with a Boolean
        <strong>OR</strong>.  For example, you may wish to search for people
        classified as White <em>or</em> as African American.
      </p>
      <p>
        The default behavior is to include as many participants as possible.  For
        example, selecting no gender filters is equivalent to <em>not</em>
        filtering by gender, which is equivalent to selecting <em>all</em>
        available filters.
      </p>
      <p>
        Filtering by <strong>Deceased Status</strong> will have the effect of
        including only deceased participant data.  If you would like to
        <em>exclude</em> deceased participant data, create a demographic
        profile in the <strong>Exclude Participants</strong> column.
      </p>
    </popper-content>
  </div>

  <div class="modal-body" id="demographics-modal-body">
    <form [formGroup]="demoForm" (ngSubmit)="onSubmit()">
      <!-- Age -->
      <div class="form-row">
        <div class="form-label">
          Age
        </div>
        <div class="control-wrapper slider-wrapper">
          <input type="number"
            id="min-age"
            [min]="minAge" [max]="maxAge"
            formControlName="ageMin"
            class="number-display">
          <div class="slider">
            <nouislider
              [min]="minAge" [max]="maxAge" [step]="1"
              [behaviour]="'drag'"
              [connect]="true"
              [formControl]="demoForm.controls.ageRange">
            </nouislider>
          </div>
          <input type="number"
            id="max-age"
            [min]="minAge" [max]="maxAge"
            formControlName="ageMax"
            class="number-display">
        </div>
      </div>

      <!-- Genders -->
      <div class="form-row">
        <div class="form-label">
          <div class="circle-wrapper">
            <div class="and-circle">AND</div>
          </div>
          Gender
        </div>
        <div class="control-wrapper">
          <app-demo-select
            [options]="genderNodes"
            [includeSearchBox]="false"
            [initialSelection]="initialGenders"
            >
          </app-demo-select>
        </div>
      </div>

      <!-- Races -->
      <div class="form-row">
        <div class="form-label">
          <div class="circle-wrapper">
            <div class="and-circle">AND</div>
          </div>
          Race
        </div>
        <div class="control-wrapper">
          <app-demo-select
            [options]="raceNodes"
            [initialSelection]="initialRaces"
            >
          </app-demo-select>
        </div>
      </div>

      <!-- Ethnicities -->
      <div class="form-row">
        <div class="form-label">
          <div class="circle-wrapper">
            <div class="and-circle">AND</div>
          </div>
          Ethnicity
        </div>
        <div class="control-wrapper">
          <app-demo-select
            [options]="ethnicityNodes"
            [initialSelection]="initialEthnicities"
            >
          </app-demo-select>
        </div>
      </div>

      <!-- Deceased status -->
      <div class="form-row">
        <div class="form-label">
          <div class="circle-wrapper">
            <div class="and-circle">AND</div>
          </div>
          Deceased
        </div>
        <div class="control-wrapper">
          <div class="checkbox">
            <input type="checkbox"
              formControlName="deceased"
              id="deceased"
              name="deceased">
            <label for="deceased">Include Only Deceased Participants</label>
          </div>
        </div>
      </div>

      <div class="form-footer">
        <button type="button"
          class="btn btn-secondary"
          (click)="onCancel()">
          Cancel
        </button>
        <button type="submit"
          class="btn btn-primary"
          (click)="onSubmit()"
          [disabled]="demoForm.invalid || !hasSelection">
          Finish
        </button>
      </div>
    </form>
  </div>
</clr-modal>
