<div class="review-name doNotPrint">
  {{cohortName}}
</div>

<ul class="nav" role="tablist">
  <li role="presentation" class="nav-item">
    <button class="btn btn-link nav-link review-button doNotPrint" [class.active]="tab === 'participants'" aria-controls="panel1"
            aria-selected="true" type="button" (click)="setTab('participants')">Participants</button>
  </li>
  <li role="presentation" class="nav-item">
    <button class="btn btn-link nav-link review-button doNotPrint" [class.active]="tab === 'report'" aria-controls="panel2"
            aria-selected="false" type="button" (click)="setTab('report')">Cohort Description</button>
  </li>
</ul>

<section role="tabpanel" aria-labelledby="tab1" [class.inactive]="tab !== 'participants'">
  <div class="participant-container">
    <div class="total-heading" *ngIf="review.queryResultSize"> Total Participants: {{review.queryResultSize | number}}</div>
  </div>
  <clr-datagrid
    (clrDgRefresh)="refresh($event)" [clrDgLoading]="loading">
    <clr-dg-placeholder>No Participants</clr-dg-placeholder>

    <clr-dg-column [clrDgField]="ColumnEnum.PARTICIPANTID" [class.gray]="isSelected(ColumnEnum[ColumnEnum.PARTICIPANTID])">
      <span class="column-title">Participant ID</span>
      <clr-dg-filter [clrDgFilter]="idFilter">
        <app-clearbutton-filter
          #idFilter
          [property]="ColumnEnum.PARTICIPANTID">
        </app-clearbutton-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column [clrDgField]="ColumnEnum.BIRTHDATE" [class.gray]="isSelected(ColumnEnum[ColumnEnum.BIRTHDATE])">
      <span class="column-title">Date of Birth</span>
      <clr-dg-filter [clrDgFilter]="dateOfBirthFilter">
        <app-clearbutton-filter
          #dateOfBirthFilter
          [property]="ColumnEnum.BIRTHDATE">
        </app-clearbutton-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column [clrDgField]="'gender'" [class.gray]="isSelected(ColumnEnum[ColumnEnum.GENDER])">
      <span class="column-title">Gender</span>
      <clr-dg-filter [clrDgFilter]="genderFilter">
        <app-multiselect-filter
          #genderFilter
          [options]="genders"
          [property]="ColumnEnum.GENDER">
        </app-multiselect-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column [clrDgField]="'race'" [class.gray]="isSelected(ColumnEnum[ColumnEnum.RACE])">
      <span class="column-title">Race</span>
      <clr-dg-filter [clrDgFilter]="raceFilter">
        <app-multiselect-filter
          #raceFilter
          [options]="races"
          [property]="ColumnEnum.RACE">
        </app-multiselect-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column [clrDgField]="'ethnicity'" [class.gray]="isSelected(ColumnEnum[ColumnEnum.ETHNICITY])">
      <span class="column-title">Ethnicity</span>
      <clr-dg-filter [clrDgFilter]="ethnicityFilter">
        <app-multiselect-filter
          #ethnicityFilter
          [options]="ethnicities"
          [property]="ColumnEnum.ETHNICITY">
        </app-multiselect-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column [clrDgField]="ColumnEnum.STATUS" [class.gray]="isSelected(ColumnEnum[ColumnEnum.STATUS])">
      <span class="column-title">Review Status</span>
      <clr-dg-filter [clrDgFilter]="statusFilter">
        <app-status-filter #statusFilter>
        </app-status-filter>
      </clr-dg-filter>
    </clr-dg-column>

    <clr-dg-row
      *ngFor="let participant of participants"
      [style.cursor]="'pointer'"
      routerLink="{{ participant.id }}">
      <clr-dg-cell>
        {{ participant.id }}
      </clr-dg-cell>
      <clr-dg-cell>
        {{ participant.birthDate }}
      </clr-dg-cell>
      <clr-dg-cell>
        {{ participant.gender | titlecase }}
      </clr-dg-cell>
      <clr-dg-cell>
        {{ participant.race | titlecase }}
      </clr-dg-cell>
      <clr-dg-cell>
        {{ participant.ethnicity | titlecase }}
      </clr-dg-cell>
      <clr-dg-cell>
        {{ participant.formattedStatusText }}
      </clr-dg-cell>
    </clr-dg-row>
    <clr-dg-footer>
      {{ pagination.firstItem + 1 }} - {{ pagination.lastItem + 1 }} of
      {{ review.queryResultSize }} Selected for Review from
      {{ review.matchedParticipantCount }} Participants
      <clr-dg-pagination #pagination
                         [clrDgTotalItems]="review.queryResultSize"
                         [clrDgPageSize]="review.pageSize"
                         [clrDgPage]="review.page + 1">
      </clr-dg-pagination>
    </clr-dg-footer>
  </clr-datagrid>
</section>
<section *ngIf="reportInit" role="tabpanel" aria-labelledby="tab2" [class.inactive]="tab !== 'report'">
  <div class="participant-container doNotPrint">
    <div class="total-heading " *ngIf="totalParticipantCount">Cohort Total: {{totalParticipantCount | number}} Participants</div>
  </div>
  <app-query-report></app-query-report>
</section>
